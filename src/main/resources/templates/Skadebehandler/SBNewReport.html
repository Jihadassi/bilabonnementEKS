<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Opret Skadesrapport</title>
    <link rel="stylesheet" th:href="@{/css/global.css}">
    <link rel="stylesheet" th:href="@{/css/sb.css}">
</head>
<body>

<div th:replace="fragments/header :: header"></div>

<div class="sb-container">
    <h2>Opret ny skadesrapport</h2>

    <form th:action="@{/sb/reports}"
          th:object="${damageReport}"
          method="post"
          class="sb-form">

        <!-- Vælg bil -->
        <label for="car">Vælg bil</label>
        <select id="car" th:field="*{carId}" onchange="updateCustomerId()">
            <option value="" disabled selected>-- Vælg bil --</option>
            <option th:each="car : ${cars}"
                    th:value="${car.carId}"
                    th:text="${car.carBrand} + ' ' + ${car.carModel}"
                    th:data-customer="${car.customerId}">
            </option>
        </select>

        <!-- Skjult customerId -->
        <input type="hidden" id="customerId" th:field="*{customerId}" />

        <!-- Beskrivelse -->
        <label for="textDescription">Beskrivelse</label>
        <textarea id="textDescription"
                  th:field="*{textDescription}"
                  rows="5"
                  placeholder="Beskriv skaden her..."></textarea>

        <!-- Pris -->
        <label for="damagePrice">Pris (kr.)</label>
        <input type="number"
               id="damagePrice"
               th:field="*{damagePrice}"
               placeholder="Indtast pris" />

        <!-- Knapper -->
        <div class="sb-button-row">
            <button type="submit" class="sb-btn-green">
                Gem rapport
            </button>

            <a th:href="${homeUrl}" class="sb-btn-red">
                Tilbage
            </a>
        </div>

    </form>
</div>

<div th:replace="fragments/footer :: footer"></div>

<script>
    function updateCustomerId() {
        const select = document.getElementById('car');
        const selectedOption = select.selectedOptions[0];
        document.getElementById('customerId').value =
            selectedOption?.dataset.customer || '';
    }
</script>

</body>
</html>
